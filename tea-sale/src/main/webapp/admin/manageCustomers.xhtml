<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui">

	<ui:composition template="/templates/mainTemplate.xhtml">
		<ui:define name="mainContent">
			<h:form id="customerListForm">
				<p:messages showDetails="false" autoUpdate="true" closable="true"/>
				<p:panel style="display: block; width: 800px; border: none; margin: 0 auto;">
					<p:scrollPanel scrollHeight="100%" mode="native" styleClass="userTable">
						<p:dataTable id="customerListTable" var="customer" value="#{customerBean.allCustomers}"
								selectionMode="single" selection="#{customerBean.customer}" rowKey="#{customer.id}"
								emptyMessage="没有客户">
							<p:ajax event="rowSelect" update="@form"/>
							<p:ajax event="rowUnselect" update="@form"/>
							<p:column headerText="会员编号" style="width: 100px">
								#{customer.memberId}
							</p:column>
							<p:column headerText="会员名称" style="width: 80px">
								#{customer.name}
							</p:column>
							<p:column headerText="联系电话" style="width: 100px">
								#{costomer.phoneNumber}
							</p:column>
							<p:column headerText="地址">
								#{customer.address}
							</p:column>
							<p:column headerText="电子邮件" style="width: 120px">
								#{customer.email}
							</p:column>
						</p:dataTable>
					</p:scrollPanel>
				</p:panel>
				
				<p:panel styleClass="bottomPanel">
					<p:commandButton value="增加客户" actionListener="#{customerBean.addCustomer}" oncomplete="PF('customerWidget').show()"
							update="@form :inputCustomerForm" resetValues="true"/>
					<p:spacer width="20px"/>
					<p:commandButton value="修改客户" disabled="#{empty customerBean.customer.id}" oncomplete="PF('customerWidget').show()"
							update="@form :inputCustomerForm" resetValues="true"/>
					<p:spacer width="20px"/>
					<p:commandButton value="删除客户" actionListener="#{customerBean.deleteCustomer}" disabled="#{empty customerBean.customer.id}" update="@form"/>
				</p:panel>
			</h:form>
		</ui:define>
		
		<ui:define name="dialogs">
			<p:dialog id="customerDlg" widgetVar="customerWidget" position="center" modal="true" resizable="false">
				<h:form id="inputCustomerForm">
					<p:messages id="messages" showDetails="false" autoUpdate="true" closable="true"/>
					<p:panelGrid columns="2">
						<p:outputLabel for="memberId" value="会员编号"/>
						<p:inputText id="memberId" value="#{customerBean.customer.memberId}" required="true"/>
						
						<p:outputLabel for="name" value="姓名"/>
						<p:inputText id="name" value="#{customerBean.customer.name}" required="true"/>
						
						<p:outputLabel for="phoneNumber"  value="联系电话"/>
						<p:inputText id="phoneNumber" value="#{customerBean.customer.phoneNumber}"/>
						
						<p:outputLabel for="email" value="电子邮件"/>
						<p:inputText id="email" value="#{customerBean.customer.email}"/>
						
						<p:outputLabel for="address" value="地址"/>
						<p:inputText id="address" value="#{customerBean.customer.address}"/>
						
					</p:panelGrid>
					
					<p:separator />
					
					<p:commandButton value="保存" actionListener="#{customerBean.saveCustomer}" update=":customerListForm"/>
					<p:commandButton value="取消" immediate="true" oncomplete="PF('customerWidget').hide()"/>
				</h:form>
			</p:dialog>
		</ui:define>
	</ui:composition>
</html>